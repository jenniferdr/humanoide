\chapter{Experimentos y Resultados}\label{chapter:resultados}
En este capítulo se describen los experimentos realizados para alanizar el desempeño del robot. Los experimentos se han dividido en tres partes. El primer conjunto de experimentos (sección \ref{sec:experimentosMov}) se ha realizado para verificar el desempeño y balance del robot al ejecutar uno o varios movimientos en secuencia. El segundo y tercer conjunto de experimentos se bas\'o en verificar el desempeño del robot al buscar la pelota. En el segundo conjunto (sección \ref{sec:experimentosintegrados}) la forma de escoger la acciónes de moviento han sido fijadas para cada región en la que se detecta la pelota. Mientras que para el tercer conjunto de experimentos (secci\'on \ref{sec:experimentosAprend}) la forma de escoger las acci\'ones de movimiento ha sido resultado del aprendizaje por reforzamiento. 
 
\section{Experimentos de Movimientos}\label{sec:experimentosMov}

Se realizaron varios experimentos para comprobar la movilidad del robot en cuanto a un conjunto de acciones de movimiento (mencionadas en la sección \ref{esqueleto}). Estas acciones son: caminar hacia adelante (4.8 cm), girar hacia la derecha (3 cm), girar hacia la izquierda (3 cm), patada con la pierna derecha, patada con la pierna izquierda, levantarse en la posición supino, levantarse en posición prono.

La primera etapa consistió en verificar el desempeño de las unidades de acciones, para ello se procedió a realizar la ejecución de cada unidad 50 veces, 250 ejecuciones en total. Se tomó nota de las veces que lograba realizar el movimiento sin fallas, es decir, de forma exitosa y de aquellas que lograba completar el movimiento pero con fallas. Los resultados obtenidos fueron un 99.6\% de casos exitosos y un 0.4\% de casos en los que pudo recuperarse de fallas. El 0.4\% representa un solo caso en el que el robot se ha caído y levantado.  

En la segunda etapa se evalu\'o la ejecuci\'on de combinaciones de varias unidades de movimiento. Las combinaciones elegidas fueron: 

\begin{itemize}
\setlength{\itemsep}{1pt}
\item Caminar hacia adelante y patear con la pierna derecha 
\item Caminar hacia adelante y patear con la pierna izquierda
\item Caminar hacia adelante, girar hacia la derecha y patear con la pierna derecha
\item Caminar hacia adelante, girar hacia la derecha, patear con la pierna izquierda 
\item Caminar hacia adelante, girar hacia la izquierda y patear con la derecha
\item Caminar hacia adelante, girar hacia la  izquierda y  patear con la pierna izquierda
\item Girar hacia la izquierda y patear con la pierna derecha
\item Girar hacia la derecha y patear con la izquierda
\item Girar hacia la derecha y patear con la pierna derecha
\item Girar hacia la izquierda y patear con la pierna izquierda
 \end{itemize}

Se realizaron 30 ejecuciones de cada una de estas combinaciones, 300 ejecuciones en total. Los resultados se muestran en el gráfico de la figura ~\ref{fig:etp2}. El resultado ha sido satisfactorio, obteniendo un 96\% de casos exitosos y un 4\% de casos con fallas, de las que ha podido recuperarse. La mayoría de las fallas se presentaron cuando al patear se caía, sin embargo lograba recuperarse.  

\begin{figure}[th!]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{96/Exitosas, 4/Con fallas corregidas}
\end{tikzpicture}
\caption{Segunda etapa: 300 ejecuciones de acciones combinadas}
\label{fig:etp2}
\end{figure}

\section{Experimentos con Comportamientos Integrados}
\label{sec:experimentosintegrados}

El segundo conjunto de experimentos consistió en la realización de pruebas de desempeño en donde se observó el comportamiento global del robot con todos sus comportamientos integrados (detección, búsqueda y pateo). La forma de elegir la acciones de movimiento es la que se describe en la sección \ref{eleccionAccionesFijas} del cap\'itulo de Búsqueda y pateo (sin aprendizaje). 

El  primer caso (CasoI) consistió en la colocación de la pelota en la zona de pateo (las regiones 1 y 2 de la figura ~\ref{divisionCam}). El número de pruebas en este primer caso fue de 10, cuya duración aproximada de cada prueba fue de 30 segundos. En la figura ~\ref{fig:caso1} se puede observar los resultados obtenidos de esta prueba.

\begin{figure}
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{90/Pateó, 10/Falló}
\end{tikzpicture}
\caption{Pruebas de movimientos integrados CASO I}
\label{fig:caso1}
\end{figure}

El segundo caso (CasoII) consistió en en la colocación inicial de la pelota a una distancia de 50 cm en línea recta al robot. Se realizaron 10 pruebas, siendo la duración promedio de 2 minutos con 12 segundos. Los resultados de dicho caso se pueden observar en la figura ~\ref{fig:caso2}. 

\begin{figure}
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{70/Exitosas, 10/Con fallas corregidas, 20/Fallidas}
\end{tikzpicture}
\caption{Pruebas de movimientos integrados CASO II}
\label{fig:caso2}
\end{figure}

El tercer caso  (CasoIII) consistió en en la colocación inicial de la pelota a una distancia de 50 cm en línea recta al robot y 10 cm a la izquierda formando asi una diagonal. Se realizaron 10 pruebas, siendo la duración promedio de 3 minutos con 29 segundos. Los resultados de dicho caso se pueden observar en la figura ~\ref{fig:caso3}. 

\begin{figure}
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{80/Exitosas, 20/Fallidas}
\end{tikzpicture}
\caption{Pruebas de movimientos integrados CASO III}
\label{fig:caso3}
\end{figure}

El cuarto caso (Caso IV) consistió en en la colocación inicial de la pelota a una distancia de 50 cm en línea recta al robot y 10 cm a la derecha. Se realizaron 10 pruebas, siendo la duración promedio de 4 minutos con 48 segundos. Los resultados de dicho caso se pueden observar en la figura ~\ref{fig:caso4}. 

\begin{figure}
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{90/Exitosas, 10/Fallidas}
\end{tikzpicture}
\caption{Pruebas de movimientos integrados CASO IV}
\label{fig:caso4}
\end{figure} 

Con un total de 40 pruebas de comportamiento integrado, los resultados obtenidos han sido satifactorios con un porcentaje de logro del 82\% mas un 5.5\% en el cual se logró recuperar y finalizar la tarea, con 12.5\% de fallas en la tarea se pudo observar de manera general que la razón de dichas fallas ha sido ocasionada por problemas de batería.
 

\section{Experimentos con Aprendizaje}\label{sec:experimentosAprend}

Finalmente, el tercer conjunto de experimentos consistió en verificar los resultados de la aplicaci\'on del apredizaje por reforzamiento, para la búsqueda de la pelota. Estos resultados se presentan a continuaci\'on.

Dentro de las fórmulas para el aprendizaje-Q se encuentran dos constantes que han sido configuradas de diferentes maneras para analizar cuál de las combinaciones brinda mejores resultados. Las constantes son la tasa de descuento $\gamma$ de la fórmula del aprendizaje-Q y la constante $K$, de la fórmula de probabilidad explicada en la secci\'on \ref{subsec:eleccionAccion}, que ajusta la distribución de probabilidad que se le da a una acción dependiendo de su valor $Q(s,a)$. Se utilizaron las siguientes combinaciones para las constantes:

\begin{itemize}
\item $K$ = 1 , $\gamma$ = 0.1
\item $K$ = 2 , $\gamma$ = 0.1 
\item $K$ = 2 , $\gamma$ = 0.7
\item $K$ = 3 , $\gamma$ = 0.1
\item $K$ = 3 , $\gamma$ = 0.7
\item $K$ = 5 , $\gamma$ = 0.1
\item $K$ = 5 , $\gamma$ = 0.7
   
\end{itemize}

Una prueba completa o prueba de comportamiento integrado se define como la colocaci\'on del robot y la pelota en posiones iniciales arbitrarias, entonces el robot debe se capaz de detectar la pelota, trasladarse hacia ella y patearla. Las pruebas se realizaron en un espacio de $1.8 m \times 1.6 m$
en donde se aseguraba que el color particular de la pelota no se repitiese, de ser así esa prueba se consideraba inválida.

Cada una de estas combinaciones se entrenó con 20 ejecuciones completas. Con los valores $Q(s,a)$ para cada estado y acción inicializados en cero (0), exceptuando los estados de la zona de pateo, que han sido inicializados con el valor 1. Una vez completados los entrenamientos se realizó un conjunto de pruebas para medir el desempeño del resultado de cada combinación y reconocer la mejor usando el porcentaje de pateos efectivos. Se realizó una prueba, de 10 ejecuciones cada una, para cada combinación. En total se realizaron 210 ejecuciones. 

Para la combinaci\'on de $K = 1$ y $ \gamma = 0.1 $ los resultados obtenidos se presentan en la figura  \ref{fig:k1y1}. Cuando $K = 1$ la probabilidad de elegir la acci\'on, dado un estado, es igual para todas las acciones, por lo tanto la elección de la acción para este caso ha sido uniformemente aleatoria. 

Los resultados del resto de las combinaciones de par\'ametros ajustables se presentan en las siguientes figuras: para $K = 2$ y $ \gamma = 0.1 $ en la figura \ref{fig:k1y1}, $K = 2$ y $ \gamma = 0.7 $ en la figura \ref{fig:k2y7}, $K = 3$ y $ \gamma = 0.1 $ en la figura \ref{fig:k3y1}, $K = 3$ y $ \gamma = 0.7 $, $K = 5$ \ref{fig:k3y7} y $ \gamma = 0.1 $ en la figura \ref{fig:k5y1} y por último $K = 5$ y $ \gamma = 0.7 $ en la figura \ref{fig:k5y7}.


\begin{figure}
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{80/Exitosas, 20/Fallidas}
\end{tikzpicture}
\caption{Prueba con  $K = 1$ y $ \gamma = 0.1 $}
\label{fig:k1y1}
\end{figure} 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{80/Exitosas, 20/Fallidas}
\end{tikzpicture}
\caption{Prueba con $K = 2$ y $ \gamma = 0.1 $}
\label{fig:k2y1}
\end{figure} 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{60/Exitosas, 40/Fallidas}
\end{tikzpicture}
\caption{Prueba  con $K = 2$ y $ \gamma = 0.7 $}
\label{fig:k2y7}
\end{figure} 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{90/Exitosas, 10/Fallidas}
\end{tikzpicture}
\caption{Prueba con $K = 3$ y $ \gamma = 0.1 $}
\label{fig:k3y1}
\end{figure} 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{80/Exitosas, 20/Fallidas}
\end{tikzpicture}
\caption{Prueba con $K = 3$ y $ \gamma = 0.7 $}
\label{fig:k3y7}
\end{figure} 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{80/Exitosas, 20/Fallidas}
\end{tikzpicture}
\caption{Prueba con $K = 5$ y $ \gamma = 0.1 $}
\label{fig:k5y1}
\end{figure} 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{70/Exitosas, 30/Fallidas}
\end{tikzpicture}
\caption{Prueba con $K = 5$ y $ \gamma = 0.7 $}
\label{fig:k5y7}
\end{figure} 

Los resultados de los entrenamientos arrojaron que la mejor combinaci\'on de fue $K = 3$ y $ \gamma = 0.1 $ que obtuvo un desempeño favorable del 90\% de las pruebas realizadas.

Con el objetivo de lograr un mejor desempeño de Junny se inicializ\'o los valores de $Q(s,a)$ con valores de recompesas negativas para aquellas acciones cuyos efectos, en un estado particular, serían obviamente erroneos. Con esto se ayuda al aprendizaje del robot, disminuyendo la probabilidad de tomar acciones ineficientes. Adem\'as se aumentó el n\'umero de pruebas de entrenamiento a 30 con el mismo objetivo.

Para medir el desempeño general de Junny, con respecto al último entrenamiento, se realizó una prueba de 15 ejecuciones colocando la pelota a distintas distancias. Los resultados de esta \'ultima pureba se presenta en el gr\'afico \ref{fig:mejor}. 

\begin{figure}[h]
\begin{tikzpicture}
\pie[pos={10 ,0}, radius =2, explode =0.3, text = legend, rotate =180]{100/Exitosas, 0/Fallidas}
\end{tikzpicture}
\caption{Prueba con $K = 3$ y $ \gamma = 0.1 $ e inicializaci\'on de Q(s,a)}
\label{fig:mejor}
\end{figure} 

Para un análisis más profundo de los resultados, se estableci\'o el n\'umero estimado de acciones esperadas, dado un estado inicial, que debe realizar el robot para llegar hasta la pelota. Con esto se puede tener una referencia de cuantas acciones debió realizar Junny en cada ejecución y comparar con el número de acciones que realmente tomó. La manera de calcular la eficiencia ha sido dividiendo la cantidad de acciones esperadas entre la cantidad de acciones realizadas. Mientras más cercana sea la eficiencia al valor 1 por la derecha, mejor es la eficiencia. Para valores menores a uno (1) significa que se realizaron menos acciones de lo esperado. Esto es posible ya que el número de acciones esperadas se calcula en base al peor de los casos.  

Para la última prueba se obtuvo una eficiencia de $0.72$. Sin embargo bajo los mismos parametros de $K = 3$ y $ \gamma = 0.1 $ con el resultado del entrenamiento con 20 pruebas (y valores de $Q(s,a)$ inicializados en cero) se obtuvo una eficiencia de $0.64$. Por lo tanto con el aumento de 10 pruebas de entrenamiento e inicialización de los valores $Q(s,a)$ se mejoró aproximadamente un 12\%. Este es un indicativo de que con mayor cantidad de pruebas este porcentaje mejorar\'a y la eficiencia aumentará.

Así mismo al comparar los tiempos promedios, con respescto a la última prueba, se obtienen los siguientes resultados. El tiempo promedio de las pruebas cuyas acciones esperadas eran menor a 8 (estados mas cercanos) fue de 4m y 19s en contraste con el promedio del tiempo de las pruebas cuyas acciones esperadas eran mayores a 8 que fue 3m y 21s.

 

   

